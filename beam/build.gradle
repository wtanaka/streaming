apply plugin: 'java'
apply plugin: 'application'
apply plugin: 'com.github.johnrengelman.shadow'

mainClassName = 'org.apache.beam.examples.WordCount'

buildscript {
	repositories {
		jcenter()
	}
	dependencies {
		classpath 'com.github.jengelman.gradle.plugins:shadow:1.2.4'
	}
}

shadowJar {
   transform(com.github.jengelman.gradle.plugins.shadow.transformers.AppendingTransformer) {
      resource = 'reference.conf'
   }
}

dependencies {
    compile fileTree(dir: 'libs', include: ['*.jar'])
    compile 'org.apache.beam:beam-sdks-java-core:0.3.0-incubating'

    // I'm unclear if this is required to be included in the fatjar
    compile 'org.apache.beam:beam-runners-flink_2.10:0.3.0-incubating'
    compile 'org.apache.flink:flink-runtime_2.10:1.1.2-hadoop1'

    testCompile 'junit:junit:4.12'
    testCompile 'org.apache.beam:beam-runners-direct-java:0.3.0-incubating'
    testCompile 'org.hamcrest:hamcrest-all:1.3'
    testCompile 'org.slf4j:slf4j-api:1.7.14'
    testCompile 'org.slf4j:slf4j-jdk14:1.7.14'
}

sourceCompatibility = "1.7"
targetCompatibility = "1.7"
